\chapter{Painel Solar}

O funcionamento de células solares é baseado no efeito fotovoltaico, ou seja, a geração de tensão ou corrente elétrica a partir da incidência de luz. O efeito fotovoltaico ocorre da seguinte maneira: em um semicondutor ideal existem dois níveis de energia que elétrons podem ser excitados, representados pela camada de valência, com energia baixa, e a camada de condução, com energia mais alta. Entre estas duas camada existe o chamado \textit{bandgap}, uma região de com níveis de energia que os elétrons não podem ter. Quando um fóton entra em contato com o semicondutor os elétrons na camada de valência absorvem sua energia e passam para a camada de condução, gerando uma corrente elétrica. Como não é possível que os elétrons possuam níveis intermediários de energia fótons que não possuam energia superior ao \textit{bandgap} não são absorvidos e passam sem interagir com a célula.\cite{jager2014}.

\section{Circuito Equivalente de um Painel Solar}

Em uma célula real existem perdas causadas por aquecimento no movimento dos elétrons, por impurezas no material que geram novos níveis de energia dentro do \textit{bandgap} e também por recombinação na junção p-n \cite{blakers2013}. Portanto para representar as células solares através de um circuito equivalente é necessário uma fonte de corrente associada com alguns componentes que representam as perdas.

O modelo para uma célula aqui utilizado é apresentado em \cite{erdem2013}. O circuito equivalente composto por uma fonte de corrente I\textsubscript{ph}, um diodo D, uma resistência paralela R\textsubscript{p} e uma resistência série R\textsubscript{s}. Este circuito pode ser encontrado na figura \ref{modelo_celula_solar}, onde I\textsubscript{ph} é a corrente fotogerada do painel, I\textsubscript{D} é a corrente do diodo, I\textsubscript{R\textsubscript{p}} é a corrente na resistência paralela, I é a corrente da célula e V é a tensão da célula.

\begin{figure}[!htpb]
\begin{center}
\begin{circuitikz} [american]
\draw
(0,0) to[I, l = I\textsubscript{ph}] (0,3) -- (2,3)
      to[diode, l = D] (2,0) -- (0,0)
(2,3) to[short] (4,3)
(4,3) to[resistor, l = R\textsubscript{p}] (4,0) -- (2,0)
(4,3) to [short] (4.5,3)
(4.5,3) to[resistor, l = R\textsubscript{s}] (6.5,3)
	  to[short, -o] (7,3)
(4,0) to[short, -o] (7,0)
(7,3) to[open, v=V] (7,0);
\draw[->] (6.25, 3.25) -- (7,3.25) node[midway, above] {I};
\draw[->] (2.25, 2.75) -- (2.25, 2) node[midway, right] {I\textsubscript{D}};
\draw[->] (4.25, 2.75) -- (4.25, 2) node[midway, right] {I\textsubscript{R\textsubscript{p}}};
\end{circuitikz}
\end{center}
\caption{Circuito equivalente da célula solar}
\label{modelo_celula_solar}
\end{figure}

A partir da análise do circuito equivalente, temos a seguinte relação entre a corrente e a tensão da celula:

\begin{equation} \label{eq:relacao_corrente_tensao_celula}
I = I_{ph} - I_{D} - I_{R_{p}}
\end{equation}

Por simplicidade e sem perda de precisão I\textsubscript{ph} pode ser determinada diretamente pela corrente de curto-circuito I\textsubscript{sc} do painel, respeitando-se a dependência com a irradiância E e a temperatura da célula T\textsubscript{c} (equação \ref{eq:corrente_fotogerada}), assim pode-se obtê-la diretamente dos \textit{datasheets} fornecidos pelos fabricantes. 

\begin{equation} \label{eq:corrente_fotogerada}
I_{ph} = I_{sc}\cdot \frac{E}{E_{0}} \cdot [1 + \Delta_{I_{sc}}(T_{c} - T_{0})]
\end{equation}

A corrente no diodo é dada pela equação \ref{eq:corrente_diodo}, onde I\textsubscript{o} é a corrente de saturação na sombra, q é a carga de um elétron, n é o fator de idealidade, k é a constante de Boltzmann e T\textsubscript{c} é a temperatura da célula \cite{bellia2014}.

\begin{equation} \label{eq:corrente_diodo}
I_{D} = I_{o}(e^{-\frac{q(V+I\cdot R_{s})}{nkT_{c}}}-1)
\end{equation}

A corrente no resistor R\textsubscript{p} pode ser obtida através da equação \ref{eq:corrente_Rp}, conhecida como lei de Ohm.

\begin{equation} \label{eq:corrente_Rp}
I_{R_{p}} = \frac{V+I\cdot R_{s}}{R_{p}}
\end{equation}

Combinando as equações apresentadas, obtem-se a equação \ref{eq:relacao_corrente_tensao_celula_com_parametros}, que mostra a relação entre a corrente e a tensão da celula solar a partir dos parâmetros do circuito equivalente.

\begin{equation} \label{eq:relacao_corrente_tensao_celula_com_parametros}
I = I_{ph} - I_{o}(e^{-\frac{q(V+I\cdot R_{s})}{nkT_{c}}}-1) - \frac{V+I\cdot R_{s}}{R_{p}}
\end{equation}

Quando várias células são conectadas em série e/ou em paralelo é formado um painel solar. As curvas características de corrente por tensão e potência por tensão de um painel podem ser vistas nas figuras \ref{figura_corrente_painel_temperatura} e \ref{figura_potencia_painel_temperatura}, onde é evidenciada a dependência com a temperatura e a irradiância. 

\pgfplotstableread[col sep = comma]{figures/solarPanelCharacteristics-25.csv}\solarPanelCharacteristicsMinusTwentyFive
\pgfplotstableread[col sep = comma]{figures/solarPanelCharacteristics0.csv}\solarPanelCharacteristicsZero
\pgfplotstableread[col sep = comma]{figures/solarPanelCharacteristics25.csv}\solarPanelCharacteristicsTwentyFive
\pgfplotstableread[col sep = comma]{figures/solarPanelCharacteristics50.csv}\solarPanelCharacteristicsFifty

\begin{figure}[!htpb]
\begin{minipage}{.5\textwidth}
\begin{center}
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[xlabel = {V [\SI{}{\volt}]}, ylabel = {I [\SI{}{\ampere}]}, ymin = 0, yticklabel style={/pgf/number format/fixed}, xtick distance=1, legend pos = south west, scale = 0.5, scale only axis]
\addplot[mark = none, color = cyan] table[x index = {0}, y index = {1}]{\solarPanelCharacteristicsMinusTwentyFive};
\addplot[mark = none, color = blue, dotted] table[x index = {0}, y index = {1}]{\solarPanelCharacteristicsZero};
\addplot[mark = none, color = magenta, dashed] table[x index = {0}, y index = {1}]{\solarPanelCharacteristicsTwentyFive};
\addplot[mark = none, color = red, dash dot] table[x index = {0}, y index = {1}]{\solarPanelCharacteristicsFifty};
\addlegendentry{\SI{-25}{\celsius}}
\addlegendentry{\SI{0}{\celsius}}
\addlegendentry{\SI{25}{\celsius}}
\addlegendentry{\SI{50}{\celsius}}
\end{axis}
\end{tikzpicture}
\caption[caption]{Corrente de um painel \\\hspace{\textwidth} solar}
\label{figura_corrente_painel_temperatura}
\end{center}
\end{minipage}
\begin{minipage}{.5\textwidth}
\begin{center}
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[xlabel = {V [\SI{}{\volt}]}, ylabel = {I [\SI{}{\watt}]}, ymin = 0, yticklabel style={/pgf/number format/fixed}, xtick distance=1, legend pos = north west, scale = 0.5, scale only axis]
\addplot[mark = none, color = cyan] table[x index = {0}, y index = {2}]{\solarPanelCharacteristicsMinusTwentyFive};
\addplot[mark = none, color = blue, dotted] table[x index = {0}, y index = {2}]{\solarPanelCharacteristicsZero};
\addplot[mark = none, color = magenta, dashed] table[x index = {0}, y index = {2}]{\solarPanelCharacteristicsTwentyFive};
\addplot[mark = none, color = red, dash dot] table[x index = {0}, y index = {2}]{\solarPanelCharacteristicsFifty};
\addlegendentry{\SI{-25}{\celsius}}
\addlegendentry{\SI{0}{\celsius}}
\addlegendentry{\SI{25}{\celsius}}
\addlegendentry{\SI{50}{\celsius}}
\end{axis}
\end{tikzpicture}
\caption[caption]{Potência de um painel \\\hspace{\textwidth} solar}
\label{figura_potencia_painel_temperatura}
\end{center}
\end{minipage}
\end{figure}

\pgfplotstableread[col sep = comma]{figures/solarPanelCharacteristics250.csv}\solarPanelCharacteristicsTwoHundredFifty
\pgfplotstableread[col sep = comma]{figures/solarPanelCharacteristics500.csv}\solarPanelCharacteristicsFiveHundred
\pgfplotstableread[col sep = comma]{figures/solarPanelCharacteristics750.csv}\solarPanelCharacteristicsSevenHundredFifty
\pgfplotstableread[col sep = comma]{figures/solarPanelCharacteristics1000.csv}\solarPanelCharacteristicsThousand

\begin{figure}[!htpb]
\begin{minipage}{.5\textwidth}
\begin{center}
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[xlabel = {V [\SI{}{\volt}]}, ylabel = {I [\SI{}{\ampere}]}, ymin = 0, yticklabel style={/pgf/number format/fixed}, xtick distance=1, legend pos = south west, scale = 0.5, scale only axis]
\addplot[mark = none, color = cyan] table[x index = {0}, y index = {1}]{\solarPanelCharacteristicsTwoHundredFifty};
\addplot[mark = none, color = blue, dotted] table[x index = {0}, y index = {1}]{\solarPanelCharacteristicsFiveHundred};
\addplot[mark = none, color = magenta, dashed] table[x index = {0}, y index = {1}]{\solarPanelCharacteristicsSevenHundredFifty};
\addplot[mark = none, color = red, dash dot] table[x index = {0}, y index = {1}]{\solarPanelCharacteristicsThousand};
\addlegendentry{\SI[per-mode=symbol]{250}{\watt\per\meter\squared}}
\addlegendentry{\SI[per-mode=symbol]{500}{\watt\per\meter\squared}}
\addlegendentry{\SI[per-mode=symbol]{750}{\watt\per\meter\squared}}
\addlegendentry{\SI[per-mode=symbol]{1000}{\watt\per\meter\squared}}
\end{axis}
\end{tikzpicture}
\caption[caption]{Corrente de um painel \\\hspace{\textwidth} solar}
\label{figura_corrente_painel_irradiância}
\end{center}
\end{minipage}
\begin{minipage}{.5\textwidth}
\begin{center}
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[xlabel = {V [\SI{}{\volt}]}, ylabel = {I [\SI{}{\watt}]}, ymin = 0, yticklabel style={/pgf/number format/fixed}, xtick distance=1, legend pos = south west, scale = 0.5, scale only axis]
\addplot[mark = none, color = cyan] table[x index = {0}, y index = {2}]{\solarPanelCharacteristicsTwoHundredFifty};
\addplot[mark = none, color = blue, dotted] table[x index = {0}, y index = {2}]{\solarPanelCharacteristicsFiveHundred};
\addplot[mark = none, color = magenta, dashed] table[x index = {0}, y index = {2}]{\solarPanelCharacteristicsSevenHundredFifty};
\addplot[mark = none, color = red, dash dot] table[x index = {0}, y index = {2}]{\solarPanelCharacteristicsThousand};
\addlegendentry{\SI[per-mode=symbol]{250}{\watt\per\meter\squared}}
\addlegendentry{\SI[per-mode=symbol]{500}{\watt\per\meter\squared}}
\addlegendentry{\SI[per-mode=symbol]{750}{\watt\per\meter\squared}}
\addlegendentry{\SI[per-mode=symbol]{1000}{\watt\per\meter\squared}}
\end{axis}
\end{tikzpicture}
\caption[caption]{Potência de um painel \\\hspace{\textwidth} solar}
\label{figura_potência_painel_irradiância}
\end{center}
\end{minipage}
\end{figure}

Como podemos ver pelas figuras, existe um ponto de máximo, conhecido como \gls{mpp}, e que este ponto varia muito com a variação da temperatura do painel e um pouco com a variação da irradiância incidente, portanto para operar o painel sempre com a maior eficiência é necessário aplicar uma técnica de controle conhecida como \gls{mppt} \cite{ahmed2016}.

\section{\glsentryshort{mppt}}

A impedância vista pelos terminais do painel determina o ponto de operação, de acordo com a equação \ref{eq:impedancia_painel}. Por conta deste fator, dificilmente um painel opera no \gls{mpp} quando conectado a uma carga arbitrária em um ambiente arbitrário. Para tal, são utilizados conversores CC-CC entre os painéis e a carga para realizar o casamento de impedância correto.

\begin{equation}
R = \frac{V}{I}
\label{eq:impedancia_painel}
\end{equation}

\subsection{Funcionamento dos Conversores CC-CC}

Para exemplificar o funcionamento dos conversores CC-CC em sistemas \gls{mppt} vamos considerar o caso de ser necessária tensão mais baixa na carga do que no painel, no qual é utilizado um conversor \textit{Buck}. O circuito deste sistema pode ser visto na figura \ref{circuito_com_conversor_buck}.

\begin{figure}[!htpb]
\begin{center}
\begin{circuitikz} [american]
\draw
(0,0) to[pvsource, l = V\textsubscript{pv}] (0,3)
      to[nos, l = S] (2,3)
(0,0) -- (2,0) to[diode, l = D]
(2,3) to[inductor, l = L] (4,3)
(4,3) to[capacitor, l = C] (4,0) -- (2,0)
(4,3) to[short] (6,3)
(6,3) to[resistor, l=R\textsubscript{L}] (6,0) -- (4,0)
(6,3) -- (8,3) to[open, v^=V\textsubscript{L}, o-o] (8,0) -- (6,0);
\draw[->] (-0.25, 2) -- (-0.25, 2.75) node[midway, left] {I\textsubscript{pv}};
\end{circuitikz}
\end{center}
\caption{Circuito com conversor \textit{Buck} para casamento de impedância}
\label{circuito_com_conversor_buck}
\end{figure}

As equações \ref{eq:ganho_estatico_conversor_buck} e \ref{eq:ganho_estatico_conversor_buck_corrente} representam o ganho estático de tensão e corrente do conversor \textit{Buck}.

\begin{equation} \label{eq:ganho_estatico_conversor_buck}
\frac{V_{L}}{V_{pv}} = D
\end{equation}

\begin{equation}\label{eq:ganho_estatico_conversor_buck_corrente}
\frac{I_{pv}}{I_{L}} = D
\end{equation}

Combinando estas duas equações na equação \ref{eq:relacao_impedancia_entrada_saida_buck} obtemos a relação entre a impedância de entrada e saída do conversor. Como a impedância de entrada é a impedância de saída do painel (carga do painel), podemos variar a razão cíclica D e consequentemente variar o ponto de operação do painel, de forma a sempre operar no ponto de máxima potência.

\begin{equation} \label{eq:relacao_impedancia_entrada_saida_buck}
\begin{aligned}
R &= \frac{V_{pv}}{I_{pv}} \\
&= \frac{V_{L}}{D} \cdot \frac{1}{I_{L}\cdot D} \\
&= \frac{1}{D^{2}} \cdot \frac{V_{L}}{I_{L}} \\
&= \frac{1}{D^{2}} \cdot R_{L}
\end{aligned}
\end{equation}

Outros exemplos de conversores CC-CC empregados em sistemas \gls{mppt} são os conversores \textit{Boost}, quando deseja-se uma tensão de saída maior que na entrada \cite{xiao2007}, e os conversores \textit{Buck-Boost}, que podem ser usados tanto para aumentar como para diminuir a tensão de saída em relação a tensão de entrada \cite{qaiser2014}.

\subsection{Algoritmos}

Em geral, é muito custoso determinar pontos de operação possíveis em quantidade suficiente para controlar o sistema \gls{mppt} de forma satisfatória, portanto é necessário o emprego de algoritmos para determinar qual deve ser o ponto de operação em tempo real \cite{al2016}.

\subsubsection{\glsentrylong{peo}}

O algoritmo \gls{peo} funciona de acordo com o fluxograma da figura \ref{fluxograma_algoritmo_peo}, no qual n é a iteração atual e P é a potência do painel. Primeiramente é gerada uma perturbação em sentido arbitrário no ponto de operação do painel. Em seguida, verifica-se se a potência entregue aumentou ou diminiu em relação a iteração anterior, caso tenha aumentado mantém-se o sentido da perturbação aplicada, caso contrário o sentido é invertido. Desta forma o sistema irá caminhar na curva de potência até atingir o \gls{mpp}, sobre o qual ficará oscilando. Com isto evidencia-se um importante \textit{trade-off}: aumentar o passo da perturbação aumenta a velocidade com que o sistema atinge o \gls{mpp}, mas ao mesmo tempo faz com que a oscilação fique mais longe do \gls{mpp}, portanto deve se encontrar um passo que satisfaça todos os requisitos de projeto.

A grande vantagem deste algoritmo é a sua simplicidade na implementação, que aliado com a sua alta eficiência quando implementado corretamente torna-o um dos algoritmos mais utilizados. A principal desvantagem é que este algoritmo demora a responder a variações grandes no ambiente. \cite{ngan2011}.

\begin{figure}[!htpb]
\begin{center}
\begin{tikzpicture}

\node [terminal, align = center](start){P(n) = 0 \\ P(n-1) = 0};
\node [process, below of=start, align = center](arbitrary_perturbation){Perturbação em Sentido Arbitrário};
\node [process, below of=arbitrary_perturbation, align = center](take_delta_P){\(\Delta\)P = P(n) - P(n-1)};
\node [decision, below of=take_delta_P, align = center](test_delta_P){\(\Delta\)P > 0?};
\node [process, left of=test_delta_P, align = center](keep_perturbation){Mantém o Sentido \\ da Perturbação};
\node [process, right of=test_delta_P, align = center](invert_perturbation){Inverte o Sentido \\ da Perturbação};
\path [line](start) -- (arbitrary_perturbation);
\path [line](arbitrary_perturbation) -- (take_delta_P);
\path [line](take_delta_P) -- (test_delta_P);
\path [line](test_delta_P) -- node[above]{sim} (keep_perturbation);
\path [line](test_delta_P) -- node[above]{não} (invert_perturbation);
\path [line](keep_perturbation) |- (take_delta_P);
\path [line](invert_perturbation) |- (take_delta_P);
\end{tikzpicture}

\end{center}
\caption{Fluxograma do algoritmo \glsentryshort{peo}}
\label{fluxograma_algoritmo_peo}
\end{figure}

\subsubsection{\glsentrylong{ci}}